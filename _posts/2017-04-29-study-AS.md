---
layout: post
title: Android源码解析之Android Studio
description: 用Android Studio阅读AOSP源码
author: 未知
date: 2017-04-29
share: true
comments: true
tag:
- Tools
---
## *1.Summary*{:.header2-font}
还是老样子，我们先来谈谈为什么要写这篇文章的原由。我们知道在阅读AOSP源码可以使用的工具有很多，轻量级的有Sublime Text、Notepad++、Atom、Vim等编辑器，重量级有Eclipse（简称ES）、Android Studio（简称AS）、Source Insight（简称SI）等IDE。而选择一款好工具，将会给你带来成倍的收益。需要工具给你提供的信息无非是，类继承结构图、被调用方法的定义或者声明的位置，文件的目录结构图，强大的搜索功能，类成员变量和成员方法的结构图，强大的编辑能力（如果需要修改AOSP的源码），集成这些功能的只有IDE这种类型的工具了。想AS、ES、SI这些都是支持导入整个工程的源码，所以使用起来非常方便。AS和ES由于设计语言的问题，对AOSP中C/C++文件支持不是很好，比如不能显示C/C++整个文件的方法、函数、类、变量，不支持函数、方法的跳转。而这一缺点SI却弥补了。所以对于Framework层以上的Java代码我使用AS/ES来阅读，其他的用SI阅读。不明白Android整个架构的可以看一下这个图。
![]({{site.baseurl}}/images/2017-04-29/2017-04-27-android_architecture.png){:.white-bg-image}

但是SI就只有这一点吸引了我，其他的功能相对AS/ES还是差太多。由于这不是一篇争论谁优谁劣，所以不做细究。只要知道，想看C/C++文件用SI是最好的。而对于ES和AS我选择了AS，google已经明确声明今后不在ES的上更新ADT插件了。而且AS不断更新的新功能也吸引了我。
## *2.About*{:.header2-font}
关于AS和google的关系网上资料很多，不做讨论。我给大家提供一个AS的官网[博客](http://tools.android.com/recent)。AS源于IDEA，可以看看IDEA对Android平台的支持官网[博客](https://www.jetbrains.com/help/idea/2017.1/android.html)
## *3.Introduction*{:.header2-font}
那么接下来就讲讲。我使用AS阅读AOSP源码的一些习惯吧。
### 导入整个AOSP源码工程{:.header3-font}
生产项目的[索引](https://android.googlesource.com/platform/development/+/master/tools/idegen/README)，按照三步走
1.全编之后，生产out目录，再单编development/tools/idegen/这个模块，可以使用make命令也可以使用mmm命令。
2.执行development/tools/idegen/idegen.sh这个脚本就会生成android.ipr和android.iml两个AS的配置文件。
3.将配置文件放在AOSP工程根目录下，用AS打开就可会开始导入整个工程了。
由于include整个工程会导致电脑内存紧张，所以我们可以exclude一些不常用的目录。可以在配置文件里面将sourceFolder标签换成excludeFolder标签，也可以在AS的设置中exclude。

### 快速定位资源位置{:.header3-font}
快捷键 
ctrl+n 查找Java类
ctrl+shift+n 查找文件
输入的查询命令   
文件夹/文件 :行数，三个参数可以搭配使用

ctrl+f  某个文件内查询
ctrl+shift+f 被工程include进来的文件
AS自带反编译功能

书签
ctrl+f11

多窗口任务处理
对比工具

### {:.header3-font}
## *4.Reference*{:.header2-font}